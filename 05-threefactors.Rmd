# 三因素实验设计 {#threefactors}

与两因素实验设计相比，三因素实验设计不仅可以探讨两个因素之间的交互效应，还可以探讨三因素之间的交互效应。因此，三因素实验设计可以获得更多的信息，实验效率也更高。

> 采用不同教学方法、教材与教学手段对学生学习成绩的影响。

## 三因素完全随机实验设计

实验有$p \times q \times r$组，随机选取 N 名被试，随机分配到各个实验组，每个被试只接受一种实验处理水平的结合。p 为自变量 A 的水平数，q 为自变量 B 的水平数，r 为自变量 C 的水平数。

### 前提条件

1. 因变量在每个实验单元内部都为正态分布，否则要求每个单元格 15 人以上才可以提高方差分析结果的可信度。
1. 因变量在所有实验单元内方差齐性，否则方差分析结果不可信。
1. 因变量在各个实验单元内相互独立，否则方差分析结果不可信。
1. 因变量应该为连续性变量。

### 统计分析思路

1. 分别检验 A、B、C 因素的主效应是否显著。
1. 分别检验 A*B、B*C、A*C 的交互效应是否显著。若显著，则进行对应两个因素的简单效应检验。
1. 检验 ABC 三阶交互效应是否显著。若显著，则进行简单简单效应检验。

### 在 SPSS 中的实现及结果解读

[练习数据](data/3factors-random.sav)

#### 初步分析

先进行初步分析，看看需要进行后续简单效应检验的元素组合。

1. 定义 A、B、C 以及因变量，输入数据。
1. 选择`分析`下的`一般线性模型`，再选`单变量`方差分析。
1. 根据研究假设，分别确定因变量和固定变量。
1. 在`选项`对话框中，选择`描述性统计`、`方差齐性检验`。
1. 执行分析程序。

输出的结果中，最重要的就是**被试间变量效应检验**表：

```{r threefactors-random-bse, echo=FALSE, fig.cap='被试间变量效应检验', fig.align='center', fig.show='hold', message=FALSE, out.width='90%'}
knitr::include_graphics(rep('images/3factors-random-tests-of-between-subjects-effects.png'))
```

在这个表中，我们可以看出 A、B、C 三个自变量的主效应均显著；AB、AC 交互效应显著；BC 交互效应不显著；ABC 交互效应显著。故有必要进行简单效应与简单简单效应检验。

#### 简单效应分析

通过绘制均值图，可更直观地显示 AB、AC 简单效应的检验结果：

1. 选择`分析`下的`一般线性模型`，再选`单变量`方差分析。
1. 根据研究假设，分别确定因变量和固定变量。
1. 点击图，选定 A 为横坐标，B 为独立拆线，单击添加；再选定 A 为横坐标，C 为独立拆线，单击添加。
1. 其它不变，运行分析程序。

输出如下交互效应结果：

```{r threefactors-random-AB, echo=FALSE, fig.cap='A*B 交互效应均值', fig.align='center', fig.show='hold', message=FALSE, out.width='90%'}
knitr::include_graphics(rep('images/3factors-random-A*B.png'))
```

接下来，复制原有语句，在语法命令中，加入`EMMEANS`语句进行简单效应检验：

```spss
UNIANOVA 成绩 BY A B C
  /METHOD=SSTYPE(3)
  /INTERCEPT=INCLUDE
  /EMMEANS = TABLES(A*B) COMPARE (B) ADJ(SIDAK)
  /EMMEANS = TABLES(A*C) COMPARE (C) ADJ(SIDAK)
  /PRINT DESCRIPTIVE HOMOGENEITY
  /CRITERIA=ALPHA(.05)
  /DESIGN=A B C A*B A*C B*C A*B*C.
```

其中，`/EMMEANS = TABLES(a*b) COMPARE(b) ADJ(SIDAK)`的功能为，在 a 的各水平上，检验 b 变量不同水平差异的显著性。计算结果如下：

```{r threefactors-random-AB-pc, echo=FALSE, fig.cap='A*B 配对比较结果', fig.align='center', fig.show='hold', message=FALSE, out.width='90%'}
knitr::include_graphics(rep('images/3factors-random-ab-pairwisecomparisons.png'))
```

上表显示，当被试使用联想策略时，无干扰条件下的记忆成绩高于有干扰条件下的记忆成绩，差异具有统计显著性。…………。

#### 简单简单效应分析

通过绘制均值图，可更直观地显示 ABC 简单简单效应的检验结果：

1. 选择`分析`下的`一般线性模型`，再选`单变量`方差分析。
1. 根据研究假设，分别确定因变量和固定变量。
1. 点击图，选定 A 为横坐标，B 为独立拆线，C 为 独立图标，单击添加；重复其它两种组合，添加。
1. 其它不变，运行分析程序。

部分结果如下：

```{r threefactors-random-ABC, echo=FALSE, fig.cap='在 A 水平下 BC 交互效应检验均值图', fig.align='center', fig.show='hold', message=FALSE, out.width='90%'}
knitr::include_graphics(rep('images/3factors-random-abc.png'))
```

接下来，复制原有语句，在语法命令中，加入`EMMEANS`语句进行简单效应检验：

```spss
UNIANOVA 成绩 BY A B C
  /METHOD=SSTYPE(3)
  /INTERCEPT=INCLUDE
  /PLOT = PROFILE(B*C*A C*A*B A*B*C)
  /EMMEANS = TABLES(A*B*C) COMPARE (C) ADJ(SIDAK)
  /EMMEANS = TABLES(B*C*A) COMPARE (A) ADJ(SIDAK)
  /EMMEANS = TABLES(C*A*B) COMPARE (B) ADJ(SIDAK)
  /PRINT DESCRIPTIVE HOMOGENEITY
  /CRITERIA=ALPHA(.05)
  /DESIGN=A B C A*B A*C B*C A*B*C.
```

其中，`/EMMEANS = TABLES(A*B*C) COMPARE(C) ADJ(SIDAK)`的功能为，在 A 的各水平上，进行`B*C`交互效应检验，在 AB 各自水平确定的条件下，进行 C 因素个水平之间的比较。对应图形为`B*C*A`。计算结果节选如下：

```{r threefactors-random-abc-pc, echo=FALSE, fig.cap='在 A 水平下 B*C 交互效应检验配对比较', fig.align='center', fig.show='hold', message=FALSE, out.width='90%'}
knitr::include_graphics(rep('images/3factors-random-abc-pc.png'))
```

上表显示，当被试使用联想策略时，无干扰条件下，被试对实物图片的记忆成绩优于对图形图片的记忆成绩，具有非常高的统计显著性差异（$P=0.000,P<0.001$)；按照表格的顺序，分别叙述剩下的组合…………。

## 重复测量一个因素的三因素混合实验

这种实验设计中，重复测量的是被试内变量 B（假设水平数为 q），如材料长短、材料类型等等。其它两个自变量为被试间变量 A（假设水平数为 p）、C（假设水平数为 r），取 N 名被试，随机分配到由被试间变量处理水平结合的 $p \times r$ 个实验组中，每位被试接受 q 个不同水平的实验处理，最终就是一个$p \times q \times r$的重复测量一个因素的三因素混合实验设计。

### 重复测量一个因素的三因素混合实验的前提条件

如果被试内变量只有 2 个水平，则只进行标准的一元方差分析，否则进行多元方差分析。

#### 一元方差分析的假设前提

1. 因变量在每个实验单元内部都为正态分布，否则要求每个单元格 15 人以上才可以提高方差分析结果的可信度。
1. 因变量在所有实验单元内方差齐性，否则方差分析结果不可信。
1. 被试样本从总体中随机抽取获得，被试间相互独立。

#### 多元方差分析的假设前提

1. 多元正态性。因变量之间的差值变量呈正态分布，大样本不受限制。
1. 被试样本从总体中随机抽取获得，被试间相互独立。

### 重复测量一个因素的三因素混合实验的统计分析思路

1. 分别检验被试间因素的主效应是否显著，检验被试间因素的交互效应是否显著。若显著，则进行对应两个因素的简单效应检验。
1. 检验被试内因素的主效应是否显著，检验被试内与被试间各个因素之间是否存在交互效应。若显著，则进行对应两个因素的简单效应检验。
1. 检验 ABC 三阶交互效应是否显著。若显著，则进行简单简单效应检验。

### 在 SPSS 中的实现及结果解读案例

如：材料类型、有无干扰、材料显示时间对记忆能力的影响。[练习数据](data/3factors-one-repeat.sav)

#### 初步分析

先进行初步分析，看看需要进行后续简单效应检验的元素组合。

1. 分别定义两个被试间自变量，然后按照被试内变量的水平数定义多个被试内变量，再输入数据。
1. 选择`分析`下的`一般线性模型`，再选`重复测量`方差分析。
1. 定义被试内变量名及其水平数。
1. 根据研究假设，分别确定被试间变量、被试内变量。
1. 在`选项`对话框中，选择`描述性统计`、`方差齐性检验`。
1. 在`EM 平均值`对话框中，将被试内变量加入到`显示平均值`中，勾选`对比主效应`，选择`LSD(none)`法对被试内因素进行多重比较。
1. 执行分析程序。

输出的结果中：

1. 描述性统计结果，可以看出各种水平结合的处理下，被试的平均值及其标准差。
1. 博克斯多元方差齐性检验结果，如果 p 值大于 0.05，则方差齐性，满足进行后续分析的条件，如果不满足，则可以通过加大样本数（每个单元格中的被试数量大于 15）的方式，进行后续分析。当实验单元内的数据大于 15 时，则不需要考虑方差是否齐性。
1. 莫奇来球形度检验表与主体内效应检验表结合在一起看，如果满足球形假设（p>0.05)，则看主体内效应检验表中的标准一元方差分析数据（第一行），否则看第二行。主体内效应检验表的数据与多元方差分析结果相同。
1. 莱文方差齐性检验的结果，决定使用何种事后检验的方法。
1. 被试间效应检验表中，可以看出两个被试间变量的主效应、交互效应是否显著。
1. 被试内因素的多重比较结果中，可以看出不同水平在什么情况下具有统计显著性差异。

#### 简单效应检验

根据初步分析的结果，对存在的两阶简单效应进行检验，明确存在显著性差异的水平结合。

作图以便直观显示简单效应，然后运行如下命令：

```spss
GLM b1 b2 b3 BY a c 
  /WSFACTOR=b 3 Polynomial 
  /METHOD=SSTYPE(3) 
  /PLOT = PROFILE(b*a)
  /EMMEANS=TABLES(b) COMPARE ADJ(LSD)
  /EMMEANS = TABLES(b*a) COMPARE(a) ADJ(SIDAK) 
  /PRINT=DESCRIPTIVE HOMOGENEITY 
  /CRITERIA=ALPHA(.05) 
  /WSDESIGN=b 
  /DESIGN=a c a*c.
```

#### 简单简单效应检验

同之前的简单简单效应检验分析方法。不再赘述。

## 重复测量两个因素的三因素混合实验

这种实验设计中，有三个自变量，两个是被试内变量，一个是被试间变量。重复测量的是被试内变量 B（假设水平数为 q），C（假设水平数为 r）。根据被试间变量 A（假设水平数为 p）随机分配到p个实验组，每个被试接受$q \times r$次测量。

### 重复测量两个因素的三因素混合实验的前提条件

如果被试内变量只有 2 个水平，则只进行标准的一元方差分析，否则进行多元方差分析。

#### 一元方差分析的假设前提

1. 因变量在每个实验单元内部都为正态分布，否则要求每个单元格 15 人以上才可以提高方差分析结果的可信度。
1. 因变量在所有实验单元内方差齐性，否则方差分析结果不可信。
1. 被试样本从总体中随机抽取获得，被试间相互独立。

#### 多元方差分析的假设前提

1. 多元正态性。因变量之间的差值变量呈正态分布，大样本不受限制。
1. 被试样本从总体中随机抽取获得，被试间相互独立。

### 重复测量两个因素的三因素混合实验的统计分析思路

1. 检验被试间变量的主效应是否显著。
1. 检验被试内变量的主效应、二阶交互效应是否显著。
1. 检验三变量的三阶交互效应是否显著。
1. 如二阶、三阶交互效应显著，则进行简单效应检验、简单简单效应检验。

### 在 SPSS 中的实现及结果解读案例

如：材料类型、有无干扰、材料显示时间对记忆能力的影响。[练习数据](data/3factors-two-repeat.sav)

#### 初步分析

先进行初步分析，看看需要进行后续简单效应检验的元素组合。

1. 先定义一个被试间自变量，然后按照两个被试内变量的水平数定义多个被试内水平结合的变量，再输入数据。
1. 选择`分析`下的`一般线性模型`，再选`重复测量`方差分析。
1. 定义被试内变量名及其水平数。
1. 根据研究假设，分别确定被试间变量、被试内变量。
1. 在`选项`对话框中，选择`描述性统计`、`方差齐性检验`。
1. 在`EM 平均值`对话框中，将水平数大于2的被试内变量加入到`显示平均值`中，勾选`对比主效应`，选择`LSD(none)`法对被试内因素进行多重比较。
1. 执行分析程序。

输出的结果中：

1. 描述性统计结果，可以看出各种水平结合的处理下，被试的平均值及其标准差。
1. 博克斯多元方差齐性检验结果，如果 p 值大于 0.05，则方差齐性，满足进行后续分析的条件，如果不满足，则可以通过加大样本数（每个单元格中的被试数量大于 15）的方式，进行后续分析。当实验单元内的数据大于 15 时，则不需要考虑方差是否齐性。
1. 莫奇来球形度检验表与主体内效应检验表结合在一起看，如果满足球形假设（p>0.05)，则看主体内效应检验表中的标准一元方差分析数据（第一行），否则看第二行。主体内效应检验表的数据与多元方差分析结果相同。
1. 莱文方差齐性检验的结果，决定使用何种事后检验的方法。
1. 被试间效应检验表中，可以看出被试间变量的主效应是否显著。
1. 被试内因素的多重比较结果中，可以看出不同水平在什么情况下具有统计显著性差异。

#### 简单效应检验

根据初步分析的结果，对存在的两阶简单效应进行检验，明确存在显著性差异的水平结合。

作图以便直观显示简单效应，然后运行命令，命令的内容可参考之前的重复测量实验设计对应内容。

#### 简单简单效应检验

同之前的简单简单效应检验分析方法。不再赘述。

## 三因素重复测量的实验设计

这种实验设计中，有三个自变量，均为被试内变量。重复测量的是被试内变量A（假设水平数为 p）、 B（假设水平数为 q），C（假设水平数为 r）。只有1个实验组，组内的每个被试接受$p \times q \times r$个实验处理水平的结合。

### 三因素重复测量的前提条件

如果被试内变量只有 2 个水平，则只进行标准的一元方差分析，否则进行多元方差分析。

#### 一元方差分析的假设前提

1. 因变量在每个实验单元内部都为正态分布，否则要求每个单元格 15 人以上才可以提高方差分析结果的可信度。
1. 因变量在所有实验单元内方差齐性，否则方差分析结果不可信。
1. 被试样本从总体中随机抽取获得，被试间相互独立。

#### 多元方差分析的假设前提

1. 多元正态性。因变量之间的差值变量呈正态分布，大样本不受限制。
1. 被试样本从总体中随机抽取获得，被试间相互独立。

### 三因素重复测量实验的统计分析思路

1. 检验被试内变量的主效应、二阶交互效应是否显著。
1. 检验三变量的三阶交互效应是否显著。
1. 如二阶、三阶交互效应显著，则进行简单效应检验、简单简单效应检验。

### 在 SPSS 中的实现及结果解读案例

如：材料类型、有无干扰、材料显示时间对记忆能力的影响。[练习数据](data/3factors-two-repeat.sav)

#### 初步分析

先进行初步分析，看看需要进行后续简单效应检验的元素组合。

1. 按照三个被试内变量的水平数定义多个被试内水平结合的变量，再输入数据。
1. 选择`分析`下的`一般线性模型`，再选`重复测量`方差分析。
1. 定义被试内变量名及其水平数。
1. 根据研究假设，分别确定被试间变量、被试内变量。
1. 在`选项`对话框中，选择`描述性统计`、`方差齐性检验`。
1. 在`EM 平均值`对话框中，将水平数大于2的被试内变量加入到`显示平均值`中，勾选`对比主效应`，选择`LSD(none)`法对被试内因素进行多重比较。
1. 执行分析程序。

输出的结果中：

1. 描述性统计结果，可以看出各种水平结合的处理下，被试的平均值及其标准差。
1. 博克斯多元方差齐性检验结果，如果 p 值大于 0.05，则方差齐性，满足进行后续分析的条件，如果不满足，则可以通过加大样本数（每个单元格中的被试数量大于 15）的方式，进行后续分析。当实验单元内的数据大于 15 时，则不需要考虑方差是否齐性。
1. 莫奇来球形度检验表与主体内效应检验表结合在一起看，如果满足球形假设（p>0.05)，则看主体内效应检验表中的标准一元方差分析数据（第一行），否则看第二行。主体内效应检验表的数据与多元方差分析结果相同。
1. 莱文方差齐性检验的结果，决定使用何种事后检验的方法。
1. 被试间效应检验表中，可以看出被试间变量的主效应是否显著。
1. 被试内因素的多重比较结果中，可以看出不同水平在什么情况下具有统计显著性差异。

#### 简单效应检验

根据初步分析的结果，对存在的两阶简单效应进行检验，明确存在显著性差异的水平结合。

作图以便直观显示简单效应，然后运行命令，命令的内容可参考之前的重复测量实验设计对应内容。

#### 简单简单效应检验

同之前的简单简单效应检验分析方法。不再赘述。
